部分代码最终版本可能有所改动，以最终版本为准：）
